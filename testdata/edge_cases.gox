package testdata

import (
	"fmt"

	"github.com/germtb/gox"
)

// ========== Deep Nesting ==========

func DeeplyNested(props gox.Props) gox.VNode {
	return <box>
		<box>
			<box>
				<box>
					<box>
						<text>Level 5</text>
					</box>
				</box>
			</box>
		</box>
	</box>
}

// ========== Arrow Functions as Props ==========

func WithCallback(props gox.Props) gox.VNode {
	return <button onClick={func() { fmt.Println("clicked") }}> Click me </button>
}

func WithArrowCallback(props gox.Props) gox.VNode {
	handler := func(x int) int { return x * 2 }
	return <input onChange={handler} onBlur={func() {}} />
}

// ========== Render Callbacks (using gox.Map) ==========

func RenderCallback(props gox.Props) gox.VNode {
	items := []string{"a", "b", "c"}
	return <list>
		{gox.Map(items, func(item string) gox.VNode {
			return <text>{item}</text>
		})}
	</list>
}

// ========== Complex Expressions ==========

func ComplexExpressions(props gox.Props) gox.VNode {
	count := 42
	name := "world"
	items := []int{1, 2, 3}
	size := func() string {
		if count > 10 {
			return "big"
		}
		return "small"
	}()

	return <box>
		<text>Count: {count}</text>
		<text>Double: {count * 2}</text>
		<text>Size: {size}</text>
		<text>Hello, {name}!</text>
		<text>Length: {len(items)}</text>
		<text>Sum: {items[0] + items[1] + items[2]}</text>
	</box>
}

// ========== Conditionals ==========

func Conditionals(props gox.Props) gox.VNode {
	showHeader := true
	showFooter := false
	count := 5

	return <box>
		{showHeader && <TestHeader title="Hello" />}
		{!showFooter && <text>No footer</text>}
		{count > 0 && <text>Has items</text>}
	</box>
}

// ========== Mixed Text and Expressions ==========

func MixedContent(props gox.Props) gox.VNode {
	name := "Alice"
	age := 30

	return <box>
		<text>Hello, {name}! You are {age} years old.</text>
		<text>Next year you'll be {age + 1}.</text>
		<text>Your name has {len(name)} letters.</text>
	</box>
}

// ========== Self-closing vs Regular ==========

func SelfClosingVariants(props gox.Props) gox.VNode {
	return <box>
		<input />
		<input type="text" />
		<br />
		<hr />
		<TestComponent />
		<TestComponent prop="value" />
		<text></text>
		<box></box>
	</box>
}

// ========== Fragments ==========

func FragmentExamples(props gox.Props) gox.VNode {
	return <>
		<text>First</text>
		<text>Second</text>
		<>
			<text>Nested fragment 1</text>
			<text>Nested fragment 2</text>
		</>
	</>
}

// ========== Component Composition ==========

func Parent(props gox.Props) gox.VNode {
	return <box>
		<Child name="Alice" age={30} />
		<Child name="Bob" age={25} />
	</box>
}

func Child(props gox.Props) gox.VNode {
	name, _ := props["name"].(string)
	age, _ := props["age"].(int)
	return <text>{name} is {age}</text>
}

// ========== Struct Props ==========

type User struct {
	Name  string
	Email string
}

func WithStructProps(props gox.Props) gox.VNode {
	user := User{Name: "Alice", Email: "alice@example.com"}

	return <box>
		<text>Name: {user.Name}</text>
		<text>Email: {user.Email}</text>
		<UserCard user={user} />
	</box>
}

func UserCard(props gox.Props) gox.VNode {
	user, _ := props["user"].(User)
	return <box>
		<text style="bold">{user.Name}</text>
		<text style="dim">{user.Email}</text>
	</box>
}

// ========== Method Calls ==========

func MethodCalls(props gox.Props) gox.VNode {
	items := []string{"hello", "world"}

	return <box>
		<text>{fmt.Sprintf("Count: %d", len(items))}</text>
		<text>{items[0]}</text>
	</box>
}

// ========== Boolean and Nil Props ==========

func BooleanProps(props gox.Props) gox.VNode {
	return <box>
		<input disabled={true} />
		<input disabled={false} />
		<button loading={true}>Submit</button>
	</box>
}

// ========== Map Literal Props ==========

func MapLiteralProps(props gox.Props) gox.VNode {
	style := map[string]any{
		"color":      "blue",
		"background": "white",
		"padding":    10,
	}
	return <box style={style}>
		<text>Styled content</text>
	</box>
}

// ========== Slice Props ==========

func SliceProps(props gox.Props) gox.VNode {
	return <list items={[]string{"a", "b", "c"}}>
		<text>List content</text>
	</list>
}

// ========== Multiline JSX ==========

func MultilineJSX(props gox.Props) gox.VNode {
	return <box
		direction="column"
		gap={10}
		style="container">
		<text style="heading"> Title </text>
		<text>Content</text>
	</box>
}

// ========== Empty Elements ==========

func EmptyElements(props gox.Props) gox.VNode {
	return <box>
		<text></text>
		<box></box>
		<></>
	</box>
}

// ========== Unicode Content ==========

func UnicodeContent(props gox.Props) gox.VNode {
	emoji := "üéâ"
	return <box>
		<text>Hello ‰∏ñÁïå!</text>
		<text>Emoji: {emoji}</text>
		<text>‚Üí Arrow ‚Üê symbols ‚Üî</text>
	</box>
}

// ========== Special Characters in Strings ==========

func SpecialChars(props gox.Props) gox.VNode {
	return <box>
		<text>Quote: "hello"</text>
		<text>Apostrophe: it's</text>
		<text>Ampersand: rock & roll</text>
		<text>Backslash: C:\path</text>
	</box>
}

// ========== JSX Comments ==========

func CommentsExample(props gox.Props) gox.VNode {
	return <box>
		{/* This is a comment */}
		<text>Visible content</text>
		{/* Another comment */}
	</box>
}

// ========== Inline Map Literals ==========

func InlineMapExample(props gox.Props) gox.VNode {
	return <box style={{
		"color":      "blue",
		"background": "white",
		"padding":    10,
	}}>
		<text>Styled content</text>
	</box>
}

// ========== Helper Components ==========

func TestHeader(props gox.Props) gox.VNode {
	title, _ := props["title"].(string)
	return <box>
		<text style="bold">{title}</text>
		<hr />
	</box>
}

func TestComponent(props gox.Props) gox.VNode {
	return <box>
		<text>Test Component</text>
	</box>
}
